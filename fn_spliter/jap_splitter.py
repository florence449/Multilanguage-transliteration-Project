katakana_pronunciation_map = {
    'ア': [['ㅇ','ㅏ'], ['ㅇ','ㅏ']],
    'イ': [['ㅇ','ㅣ'], ['ㅇ','ㅣ']],
    'ウ': [['ㅇ','ㅜ'], ['ㅇ','ㅜ']],
    'エ': [['ㅇ','ㅔ'], ['ㅇ','ㅔ']],
    'オ': [['ㅇ','ㅗ'], ['ㅇ','ㅗ']],

    'カ': [['ㄱ','ㅏ'], ['ㅋ','ㅏ']],
    'キ': [['ㄱ','ㅣ'], ['ㅋ','ㅣ']],
    'ク': [['ㄱ','ㅜ'], ['ㅋ','ㅜ']],
    'ケ': [['ㄱ','ㅔ'], ['ㅋ','ㅔ']],
    'コ': [['ㄱ','ㅗ'], ['ㅋ','ㅗ']],

    'サ': [['ㅅ','ㅏ'], ['ㅅ','ㅏ']],
    'シ': [['ㅅ','ㅣ'], ['ㅅ','ㅣ']],
    'ス': [['ㅅ','ㅜ'], ['ㅅ','ㅜ']],
    'セ': [['ㅅ','ㅔ'], ['ㅅ','ㅔ']],
    'ソ': [['ㅅ','ㅗ'], ['ㅅ','ㅗ']],

    'タ': [['ㄷ','ㅏ'], ['ㅌ','ㅏ']],
    'チ': [['ㅈ','ㅣ'], ['ㅊ','ㅣ']],
    'ツ': [['ㅆ','ㅡ'], ['ㅆ','ㅡ']],
    'テ': [['ㄷ','ㅔ'], ['ㅌ','ㅔ']],
    'ト': [['ㄷ','ㅗ'], ['ㅌ','ㅗ']],

    'ナ': [['ㄴ','ㅏ'], ['ㄴ','ㅏ']],
    'ニ': [['ㄴ','ㅣ'], ['ㄴ','ㅣ']],
    'ヌ': [['ㄴ','ㅜ'], ['ㄴ','ㅜ']],
    'ネ': [['ㄴ','ㅔ'], ['ㄴ','ㅔ']],
    'ノ': [['ㄴ','ㅗ'], ['ㄴ','ㅗ']],

    'ハ': [['ㅎ','ㅏ'], ['ㅎ','ㅏ']],
    'ヒ': [['ㅎ','ㅣ'], ['ㅎ','ㅣ']],
    'フ': [['ㅎ','ㅜ'], ['ㅎ','ㅜ']],
    'ヘ': [['ㅎ','ㅔ'], ['ㅎ','ㅔ']],
    'ホ': [['ㅎ','ㅗ'], ['ㅎ','ㅗ']],

    'マ': [['ㅁ','ㅏ'], ['ㅁ','ㅏ']],
    'ミ': [['ㅁ','ㅣ'], ['ㅁ','ㅣ']],
    'ム': [['ㅁ','ㅜ'], ['ㅁ','ㅜ']],
    'メ': [['ㅁ','ㅔ'], ['ㅁ','ㅔ']],
    'モ': [['ㅁ','ㅗ'], ['ㅁ','ㅗ']],

    'ラ': [['ㄹ','ㅏ'], ['ㄹ','ㅏ']],
    'リ': [['ㄹ','ㅣ'], ['ㄹ','ㅣ']],
    'ル': [['ㄹ','ㅜ'], ['ㄹ','ㅜ']],
    'レ': [['ㄹ','ㅔ'], ['ㄹ','ㅔ']],
    'ロ': [['ㄹ','ㅗ'], ['ㄹ','ㅗ']],

    'ガ': [['ㄱ','ㅏ'], ['ㄱ','ㅏ']],
    'ギ': [['ㄱ','ㅣ'], ['ㄱ','ㅣ']],
    'グ': [['ㄱ','ㅜ'], ['ㄱ','ㅜ']],
    'ゲ': [['ㄱ','ㅔ'], ['ㄱ','ㅔ']],
    'ゴ': [['ㄱ','ㅗ'], ['ㄱ','ㅗ']],

    'ザ': [['ㅈ','ㅏ'], ['ㅈ','ㅏ']],
    'ジ': [['ㅈ','ㅣ'], ['ㅈ','ㅣ']],
    'ズ': [['ㅈ','ㅡ'], ['ㅈ','ㅡ']],
    'ゼ': [['ㅈ','ㅔ'], ['ㅈ','ㅔ']],
    'ゾ': [['ㅈ','ㅗ'], ['ㅈ','ㅗ']],

    'ダ': [['ㄷ','ㅏ'], ['ㄷ','ㅏ']],
    'ヂ': [['ㅈ','ㅣ'], ['ㅈ','ㅣ']],
    'ヅ': [['ㅈ','ㅡ'], ['ㅈ','ㅡ']],
    'デ': [['ㄷ','ㅔ'], ['ㄷ','ㅔ']],
    'ド': [['ㄷ','ㅗ'], ['ㄷ','ㅗ']],

    'バ': [['ㅂ','ㅏ'], ['ㅂ','ㅏ']],
    'ビ': [['ㅂ','ㅣ'], ['ㅂ','ㅣ']],
    'ブ': [['ㅂ','ㅜ'], ['ㅂ','ㅜ']],
    'ベ': [['ㅂ','ㅔ'], ['ㅂ','ㅔ']],
    'ボ': [['ㅂ','ㅗ'], ['ㅂ','ㅗ']],

    'パ': [['ㅍ','ㅏ'], ['ㅍ','ㅏ']],
    'ピ': [['ㅍ','ㅣ'], ['ㅍ','ㅣ']],
    'プ': [['ㅍ','ㅜ'], ['ㅍ','ㅜ']],
    'ペ': [['ㅍ','ㅔ'], ['ㅍ','ㅔ']],
    'ポ': [['ㅍ','ㅗ'], ['ㅍ','ㅗ']],

    'ワ': [['ㅇ','ㅘ'], ['ㅇ','ㅘ']],
    'ヰ': [['ㅇ','ㅣ'], ['ㅇ','ㅣ']],
    'ヲ': [['ㅇ','ㅗ'], ['ㅇ','ㅗ']],

    'ヤ': [['ㅇ','ㅑ'], ['ㅇ','ㅑ']],
    'ユ': [['ㅇ','ㅠ'], ['ㅇ','ㅠ']],
    'ヨ': [['ㅇ','ㅛ'], ['ㅇ','ㅛ']],

    'ヴ': [['ㅂ','ㅜ'], ['ㅂ','ㅜ']],
}

katakana_pronunciation_spacial_map = {
    'ャ', 'ュ', 'ョ', 'ッ', 'ン', 'ェ', 'ォ', 'ィ'
}

def katakana_splitter(word):
    result = []
    i = 0
    for i, char in enumerate(word):

        if char in katakana_pronunciation_map and (
            i == 0 or word[i-1] == ' '):
            pronunciation = katakana_pronunciation_map[char][0]
            result.append([char, pronunciation[0], 'consonant'])
            result.append([char, pronunciation[1], 'vowel'])

        elif char in katakana_pronunciation_map:
            pronunciation = katakana_pronunciation_map[char][1]
            result.append([char, pronunciation[0], 'consonant'])
            result.append([char, pronunciation[1], 'vowel'])

        elif char in katakana_pronunciation_spacial_map:
            result.append([char,char,'jap_special'])

        else:
            print(f"ERROR: {word[i]}가 딕셔너리에서 누락됨.")

    return result

def katakana_correcter(phoneme_list):
    result = []

    for i, current_phoneme in enumerate(phoneme_list):
        current_phoneme = phoneme_list[i]

        current_code = current_phoneme[0]
        current_kor_code = current_phoneme[1]
        current_type = current_phoneme[2]

        if current_type == 'vowel' and i + 1 < len(phoneme_list):
            if phoneme_list[i +1][0] == 'ャ':
                result.append([current_code, 'ㅑ', current_type])

            elif phoneme_list[i +1][0] == 'ュ':
                result.append([current_code, 'ㅠ', current_type])

            elif phoneme_list[i +1][0] == 'ョ':
                result.append([current_code, 'ㅛ', current_type])

            elif phoneme_list[i +1][0] == 'ェ':
                result.append([current_code, 'ㅔ', current_type])

            else:
                result.append(current_phoneme)

        elif current_type == 'jap_special':
            if current_code == 'ッ':
                result.append([current_code, 'ㅅ', 'consonant'])
            elif current_code == 'ン':
                result.append([current_code, 'ㄴ', 'consonant'])
            else:
                pass

        else:
            result.append(current_phoneme)

    return result

def jap_splitter(word):
    phoneme_list = katakana_splitter(word)
    result = katakana_correcter(phoneme_list)
    return result